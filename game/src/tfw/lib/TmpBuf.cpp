/***********************************************************************//**
 *	TmpBuf.cpp
 *	Terras Framework
 *	
 *	Created by Ryoutarou Kishi on 2012/12/07.
 *	Copyright 2012 Altoterras Corporation. All rights reserved.
 *
**//***********************************************************************/

////////////////////////////////////////////////////////////////////////////
// インクルードファイル

// Base

// Self
#include "TmpBuf.h"

// Friends

// External

// Library

TFW_BEGIN_NS

////////////////////////////////////////////////////////////////////////////
// クラス

//==========================================================================
// TmpBuf メソッド

// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
// 外部サービス

/*---------------------------------------------------------------------*//**
	作成
**//*---------------------------------------------------------------------*/
u8* TmpBuf::make(u32 sizeNeed, u8* bufStack, u32 sizeStackBuf)
{
	_size = sizeNeed;
	if(_size <= sizeStackBuf)
	{
		_buf = bufStack;
		_flags = F_USE_STACK;
	}
	else
	{
		_buf = new u8[sizeNeed];
		_flags = 0;
	}
	return _buf;
}

// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
// 内部制御

/*---------------------------------------------------------------------*//**
	コンストラクタ
**//*---------------------------------------------------------------------*/
TmpBuf::TmpBuf()
	: _buf(0L)
	, _size(0)
	, _flags(0)
{
}

/*---------------------------------------------------------------------*//**
	コンストラクタ
**//*---------------------------------------------------------------------*/
TmpBuf::TmpBuf(u32 sizeNeed, u8* bufStack, u32 sizeStackBuf)
	: _buf(0L)
	, _size(0)
	, _flags(0)
{
	make(sizeNeed, bufStack, sizeStackBuf);
}

/*---------------------------------------------------------------------*//**
	デストラクタ
**//*---------------------------------------------------------------------*/
TmpBuf::~TmpBuf()
{
	if(!TFW_IS_FLAG(_flags, F_USE_STACK))
	{
		delete[] _buf;
	}
}

////////////////////////////////////////////////////////////////////////////

TFW_END_NS
